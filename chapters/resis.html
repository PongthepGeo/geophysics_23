<!DOCTYPE html>
<html>
<body>

<h2>
    Electrical Resistivity Tomography (ERT)
</h2>

<div style="padding: 20px 0;">
    <img src="https://drive.google.com/uc?id=1Vj2YiNGFUxCIc7i8D5mJBUTl-ZNloBbg" alt="pipeline" style="max-width:100%;">
</div>

<h3>1) Introduction</h3>

<p>
	Please cite

	Electrical Resistivity Tomography (ERT). (n.d.). https://www.sepgeophysical.com/geophysical-survey-services/electrical-resistivity-tomography-ert/. Accessed 15 July 2023, 
</p>

<p>
About Electrical Resistivity Tomography (ERT)
The Electrical Resistivity Tomography (ERT) method is one of the longest-established techniques for geophysical investigations. The basis of the method is that current is injected into the ground through electrodes, a resulting potential is measured which allows for the calculation of resistance and hence resistivity.

Variations in electrical resistivity typically correlate with variations in lithology, water saturation, fluid conductivity, porosity and permeability, which may be used to map stratigraphic units, geological structures, sinkholes, fractures and groundwater.

The ERT method is often used in conjunction with other reconnaissance geophysical methods, such as electromagnetic mapping or ground-penetrating radar (GPR), to help further constrain any anomalous areas. It also complements other profile mapping techniques such as seismic refraction and MASW.
</p>

<h4>1.1) Applications of Electrical Resistivity Tomography (ERT)</h4>

<p>
ERT is a very versatile geophysical method with many potential applications. In general, ERT is used to map variations in subsurface resistivity measurements, which in turn can be related to changes in subsurface lithology, water saturation, fluid conductivity, porosity and permeability.
</p>

<p>
The main applications of ERT are in engineering and environmental geophysics, although the method is also used in hydrogeology, archaeology, mineral exploration and crime scene investigation. Common applications for resistivity data include:
</p>

<ul>
    <li>Identifying areas of potential instability or slope failure</li>
    <li>Mapping the depth to bedrock</li>
    <li>Delineating aquifers and aquitards</li>
    <li>Detecting leaks from landfill sites and hazardous waste disposal sites</li>
    <li>Mapping the extent of contamination plumes in soil and groundwater</li>
    <li>Locating buried channels, dikes, or other structures that may impede groundwater flow</li>
    <li>Locating areas of potential sinkhole collapse</li>
    <li>Studying the effects of dewatering or other fluid injection/extraction processes on subsurface fractures</li>
</ul>

<h4>1.2) Benefits of Electrical Resistivity Tomography (ERT)</h4>

<p>
Benefits of Electrical Resistivity Tomography (ERT)
There are many benefits to using ERT over other geophysical methods. These include:
</p>

<ul>
    <li><b>Non-invasive</b> - ERT is a completely non-destructive method that has no effect on the environment.</li>
    <li><b>Repeatable</b> - Resistivity measurements can be made at any time and under any conditions, making it ideal for long-term monitoring applications.</li>
    <li><b>Versatile</b> - ERT can be used in a wide range of different environments, from deep mines to shallow wetlands.</li>
    <li><b>Flexible</b> - ERT surveys can be tailored to meet the specific needs of the project. For example, the electrode spacing and array configuration can be varied to achieve the desired depth of investigation and resolution.</li>
    <li><b>Cost-effective</b> - ERT is a relatively low-cost geophysical method, especially when compared to invasive methods.</li>
</ul>

<h4>1.3) Performing an Electrical Resistivity Tomography Survey</h4>

<p>
Resistivity imaging involves measuring a series of readings along a profile with the electrodes at a set spacing. The resistivity data can be collected using a variety of electrode array configurations, the choice being selected by the geophysicist on-site to meet the objectives of the survey.

Electrical resistivity imaging provides a complete data set from very close to the surface to a considerable depth. The depth of investigation and the resolution achieved are dependent on the electrode spacing and electrode configuration used. Longer spreads will achieve a greater depth, trading resolution to do so.

The apparent resistivity values are affected by a number of factors and it is important, therefore, that the geophysicist considers all relevant information when interpreting resistivity data. Different materials have different resistivity values, which means that the interpretation of ERT profiles requires an understanding of the geology and hydrogeology in the area under investigation.

High resistivity values indicate a low conductivity and are usually associated with materials such as air, sand or gravel. A low resistivity value indicates a high conductivity and is usually associated with materials such as clay or water.
</p>

<h3>2) Direct Current (DC) Resistivity</h3>

<h4>2.1) Field and Potential</h4> 
<h5>2.1.1) Gravity Field vs. Electric Field</h5> 

<div style="padding: 20px 0;">
    <img src="https://drive.google.com/uc?id=1UpxUUVjfEm54nLJInurhnygWcYk6i9ud" alt="pipeline" style="max-width:100%;">
</div>

Both gravity and electric fields exert forces that influence matter. The strengths of these fields can be evaluated by introducing relevant matter which reacts to these forces.

In the context of a gravitational field, introducing a point mass allows the observation of a force pulling it towards the larger mass. This force's intensity is directly proportional to the strength of the gravitational field, thereby providing a method to gauge it.

Conversely, an electric field exhibits similar behavior when a charge is introduced. The reaction of the test charge is contingent on its nature and the source's nature. If the source and test charges are positive, they repel each other due to the like-charges repulsion principle. However, if the charges are of opposite nature - one positive and the other negative - they attract each other, demonstrating the principle of opposite charges attraction.

Thus, the interaction of a test mass or charge within a gravity or electric field, respectively, offers an effective method to measure the strength of these fields. The observed attractive or repulsive forces provide essential information on the fields' characteristics and strengths.

<h5>2.1.2) Electrical Dipole</h5> 

<figure id="resis_fig_02">
    <div style="padding: 20px 0;">
        <img src="https://drive.google.com/uc?id=14n2dTSSF6i8aBlNJUhAiF7atSpkIS3tt"
        alt="resis_fig_02" style="max-width:100%;">
    </div>
    <figcaption>
		<strong style='color:#ade4f0'>
            Fig.2: Electrical Dipole.   
        </strong>
        An electric dipole consists of two equal and opposite charges separated by a distance. This configuration generates both electric field lines and equipotential surfaces. 
	</figcaption>
</figure>

1. Electric Field Lines:

   Electric field lines give us a pictorial representation of the electric field produced by the dipole. They originate from the positive charge and terminate at the negative charge. They represent the direction of the electric field, which is the direction that a positive test charge would move if placed in the field.

   In the vicinity of the charges, the field lines are approximately radial, similar to the field lines of isolated charges. But at larger distances, the field lines start to curve and point from the positive to the negative charge.

   Field lines in the middle of the dipole, between the two charges, are straight and point directly from the positive to the negative charge.

2. Equipotential Surfaces:

   Equipotential surfaces are surfaces where the electric potential is the same at all points. This means that no work is done by the electric field in moving a test charge along an equipotential surface.

   For an electric dipole, these surfaces take the form of a series of nested, distorted spheres or ellipsoids. Right at the midpoint between the two charges, the equipotential surface is a plane perpendicular to the line joining the charges.

   On this plane, the potential is zero (if we consider the potential at infinity as zero). As we move towards the positive charge, the potential increases and the equipotential surfaces become increasingly positively distorted spheres. As we move towards the negative charge, the potential decreases and the equipotential surfaces become increasingly negatively distorted spheres.

   Remember that the electric field lines are always perpendicular to the equipotential surfaces, which is why no work is done moving along an equipotential surface.

In summary, the electric field lines and equipotential surfaces provide a complete picture of the electric field and potential created by an electric dipole.

<strong style='color:#AD79A8'> 1) Excercise </strong>

How can human "see" electric lines and  equipotential surfaces?

<h5>2.1.3) Lightning: Multiple Electrical Poles</h5> 

<figure id="resis_fig_03">
    <div style="padding: 20px 0;">
        <img src="https://drive.google.com/uc?id=1rzfDlQce5hqBnrl3e2rQ4EGm9zisvxK5"
        alt="resis_fig_03" style="max-width:100%;">
    </div>
    <figcaption>
		<strong style='color:#ade4f0'>
            Fig.3: Lightning.   
        </strong>
        Lightning can be thought of as a dramatic and large-scale demonstration of electric fields and their associated forces. In many ways, lightning can be conceptually related to the more abstract concept of electric multipoles, such as dipoles, quadrupoles, and so on. 
	</figcaption>
</figure>

Electric multipoles are an extension of the concept of charge. A simple charged particle is a monopole. When two charges of equal magnitude and opposite sign are brought close together, they form an electric dipole. More complex arrangements of charges give rise to higher multipoles, like quadrupoles, octupoles, etc.

A lightning strike represents a strong electric dipole moment in nature, albeit on a much larger scale than usually considered in physics problems. The dipole is formed by the separation of charge between the ground (generally negatively charged) and the cloud (generally positively charged). This charge separation generates an intense electric field. When the electric field strength becomes too great, the air becomes ionized (forming a plasma), creating a path of least resistance for the charges to equalize. This equalization process is the lightning bolt, an energetic discharge following the path of the plasma channel.

In more complex storm systems, there can be various regions of differing charge, leading to a situation more akin to a multipole rather than a simple dipole, with multiple lightning strikes following different paths to equalize the various regions of charge. However, it's worth noting that these systems are far more complicated and chaotic than the idealized static charge distributions usually considered when studying multipoles in physics.

In conclusion, while lightning and electric multipoles are different in terms of scale and complexity, both stem from the principles of electric charge and electric fields, making them conceptually related.

<strong style='color:#AD79A8'> 2) Excercise </strong>

Please try to relate <a href="#resis_fig_02">Figure 2</a> and <a href="#resis_fig_03">Figure 3</a>. For example, the lightning strike is equivalent to what component in electrical dipole?

<strong style='color:#AD79A8'> 3) Excercise </strong>

Modifying the gravity force vectors based on the code below to compute a vector field that interacts with $F = q_oE$.

Please ensure to replace $q_oE$ with the appropriate values or variables as per your specific calculation or simulation. Here $q_o$ represents the test charge and $E$ represents the electric field. The force $F$ on the test charge due to the electric field is given by this equation.

<div style="padding: 20px 0;">
    <img src="https://drive.google.com/uc?id=1dc0eyjAfEbF_CC6E4uMwe7BpjgmHeIwN"
    alt="resis_fig_03" style="max-width:100%;">
</div>

```python
#-----------------------------------------------------------------------------------------#
import utilities as U
import numpy as np
#-----------------------------------------------------------------------------------------#

# Define position of object mass
x0 = 5; y0 = 5

# Calculate distance from the Earth position (0, 0) to the object mass
r = np.sqrt(x0**2 + y0**2)

# Define constants
m = 1e24  # object mass in kg 
M = 5.972e24  # Earth mass in kg
G = 6.67430e-11  # gravitational constant in m^3 kg^-1 s^-2

# Normalize the x and y coordinates for the direction
rx = x0 / r
ry = y0 / r

# Calculate the gravitational force vectors
F = G * M * m / r**2
Fg_x = - F * rx  # gravitational force in x direction
Fg_y = - F * ry  # gravitational force in y direction

U.Earth_field(x0, y0, Fg_x, Fg_y)
```

<h4>2.0) The Resistivity Quadrupole and Apparent Resistivity of Speciﬁc Resistivity
Structures</h4>

<p>
	Please cite

	Binley, A., Slater, L. (2020). Resistivity and Induced Polarization: Theory and Applications to the Near-Surface Earth (1st edition). Cambridge University Press.
</p>

In order to develop equations relating four-electrode measurements to the resistivity of the
subsurface, we must ﬁrst understand the spatial pattern of electrical potential due to current injected from an electrode. For a $3D$, isotropic, electrical resistivity distribution, $ρ(x, y, z)$, the electric potential (voltage), $V(x, y, z)$, due to a single (point) current electrode, with strength $I$, located at coordinates $xc, yc, zc$, is deﬁned by $a$ form of the Poisson equation:

$$
\begin{align*}
{\nabla \left(\frac{1}{\rho } \nabla V\right) =-I\delta ( x_{c} ,\ y_{c} ,\ z_{c})} \tag{1}
\end{align*}
$$
<div id="eq1"></div>

where $\nabla =\frac{\partial }{\partial x} +\frac{\partial }{\partial y} +\frac{\partial }{\partial z}$ and $\delta ( x,\ y,\ z)$ is the Dirac delta function (which takes on a value of 1
at the position x, y, z and is 0 elsewhere).

<a href="#eq1">Equation 1</a> is normally considered to be subject to boundary conditions:

$$
\begin{align*}
{\left(\frac{1}{\rho }\right)\frac{\partial V}{\partial n} =0} \tag{2}
\end{align*}
$$
<div id="eq2"></div>

where $n$ is the outward normal. Such conditions are called Neumann (or second type) and
impose the condition of no ﬂux into or out of the ground (except of course at the current
electrode location).

For the case of homogenous resistivity, $ρ$, with current injection at a depth beyond the
inﬂuence of the ground surface (which is ﬂat and at $z = 0$), the solution of <a href="#eq1">Equation 1</a> gives the voltage at coordinates $x_p ; y_p ; z_p$ as

$$
\begin{align*}
{V( x_{p} ,\ y_{p} ,\ z_{p}) =\frac{I\rho }{4\pi r}} \tag{3}
\end{align*}
$$
<div id="eq3"></div>

where r is the distance between current source and potential measurement, i.e., $r\ =\sqrt{( x_{p} -x_{c})^{2} +( y_{p} -y_{c})^{2} +( z_{p} -z_{c})^{2}}$

The general case where the current is injected at a shallow depth (i.e. the potential ﬁeld is
affected by the non-conducting air at the ground surface) is easily derived by the method of
images. For this case, the solution is the superposition of two solutions using <a href="#eq3">Equation 3</a>: one based on the real electrode at $x_c, y_c, z_c,$ and the other based on an imaginary electrode at
$x_c, y_c, –z_c$. The solution is

$$
\begin{align*}
{V( x_{p} ,\ y_{p} ,\ z_{p}) =\frac{I\rho }{4\pi r} +\frac{I\rho }{4\pi r_{i}}} \tag{4}
\end{align*}
$$
<div id="eq4"></div>

where r is deﬁned as before and $r_i\ =\sqrt{( x_{p} -x_{c})^{2} +( y_{p} -y_{c})^{2} +( z_{p} -z_{c})^{2}}$.

<a href="#eq4">Equation 4</a> is needed for the general case, e.g. where electrodes deployed in boreholes are used, but for the common arrangement of surface electrodes $(z_c = 0, z_p = 0) r_i = r,$ and so

$$
\begin{align*}
{V( x_{p} ,\ y_{p} ,\ 0) =\frac{I\rho }{4\pi r} +\frac{I\rho }{4\pi r} =\frac{I\rho }{2\pi r}} \tag{5}
\end{align*}
$$
<div id="eq5"></div>

<p></p>
<details>
<summary>
<strong style='color:#AD79A8'> 5) Excercise </strong>
</summary>

<a href="#eq5">Equation 5</a> represent injected current electrode that can generate electric potential into a half-space model. Following the code below to generate the point source at surface-like model.

<div style="padding: 20px 0;">
    <img src="https://drive.google.com/uc?id=1s6FcUqejaVzQEpJRmlPC-uv25EjnTUYe"
    alt="fig 3" style="max-width:100%;">
</div>

</details>

<p></p>
<details>
<summary>
<strong style='color:#F29879'>Answer Ex. (5)</strong>
</summary>

```python
#-----------------------------------------------------------------------------------------#
import utilities as U
import numpy as np
#-----------------------------------------------------------------------------------------#

# Grid size
size_x = 20
size_y = 20
# Create a 2D grid
grid_x, grid_y = np.meshgrid(np.linspace(-50, 50, size_x), np.linspace(-50, 50, size_y))
# Electrode position (center of the grid)
x_source = 0.0
y_source = 0.0
# Current and resistivity
I = 150.0
rho = 1.0

#-----------------------------------------------------------------------------------------#

# Calculate the potential for the entire grid
V = U.calculate_potential(grid_x, grid_y, x_source, y_source, I, rho)
U.plot_contours(grid_x, grid_y, V)

#-----------------------------------------------------------------------------------------#
```
</details>

</body>
</html>